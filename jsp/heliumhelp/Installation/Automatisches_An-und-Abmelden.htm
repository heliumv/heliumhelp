<html>

<head>
<meta http-equiv="Content-Language" content="de">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="stylesheet" type="text/css" href="../css/main.css">
<title>Automatisches AN- und Abmelden</title>
</head>

<body>

<h1>Automatisches An- und Abmelden</h1>
<p class="answer">In Kombination mit der HELIUM V Quickzeiterfassung ist es
manchmal erwünscht, dass für den Benutzer bei erfolgter Anmeldung bzw. beim
Abmelden vom System automatische Kommt / Geht Buchungen durchgeführt werden.<br>
Dafür steht das Programm lpquickze.jar zur Verfügung, welches Sie auf
Anforderung gerne von uns zur Verfügung gestellt bekommen.</p>
<p class="answer">Für die automatische Anmeldung am HELIUM V Client <a href="../Client/Client_Install.htm#Automatische Client Anmeldung">siehe</a>.</p>
<p class="answer">Die Einrichtung der automatischen Ausführung dieses / dieser
Programme ist sehr stark Betriebssystem abhängig.<br>
Zusätzlich kann / müssen in den Properties der lpquickze.jar (lpquickze_Kommt.jar\com\lp\lpquickze\props.properties)
die Buchungs-IDs der beim Aufruf des Programms zu buchenden Sondertätigkeiten
angeführt werden. Es empfiehlt sich daher, für Kommt und Geht die
Programmnamen entsprechen unterschiedlich zu benennen. Z.B.: lpquickze_Kommt.jar
für Kommt.<br>
Die Buchungs-IDs sind:<br>
11 ... Kommt<br>
12 ... Geht<br>
13 ... UNTER (also Pause Beginn bzw. Ende)<br>
In den Properties müssen auch der Loginname, das erforderliche Passwort und das
Locale (Sprache) definiert werden.<br>
Zusätzlich stehen noch zwei Spezialbuchungen zur Verfügung:<br>
http://localhost:8080/ze/ze?cmd=quickzeiterfassung&amp;buchesondertaetigkeit=true&amp;zusatz=spezialkommt<br>
http://localhost:8080/ze/ze?cmd=quickzeiterfassung&amp;buchesondertaetigkeit=true&amp;zusatz=spezialgeht<br>
<br>
<br>
Nachfolgend die Beschreibung für Windows XP professional ab SP2:<br>
Starten Sie den Gruppenrichtlinien Editor durch Start, Ausführen, Gpedit.msc.<br>
Hinweis: Die Gruppenrichtlinien müssen nicht unbedingt mit
Domain-Gruppenrichtlinien kombiniert werden. Bitte beachten Sie dass die
nachfolgende Beschreibung für einen lokalen Computer erstellt wurde, was
bedeutet, dass diese Definition auf jedem Rechner in Ihrem Netzwerk gemacht
werden muss. Für eine allgemeine Definition wenden Sie sich bitte an Ihren
Netzwerkbetreuer.<br>
Nun wählen Sie, Benutzerkonfiguration, Windows-Einstellungen, Skripts
(Anmelden/Abmelden)<br>
<img border="0" src="Gruppenrichtlinien.jpg" width="407" height="315">&nbsp;<br>
Nun definieren Sie die beim Anmelden und Abmelden auszuführenden Skripts.
Kopieren Sie dazu vorher die wie oben beschrieben modifizierten
lpquickze_Kommt.jar nach <a href="file:///c:/WINDOWS/system32/GroupPolicy/User/Scripts/Logon">c:\WINDOWS\system32\GroupPolicy\User\Scripts\Logon</a>
bzw. für das Geht nach <a href="file:///c:/WINDOWS/system32/GroupPolicy/User/Scripts/Logoff">c:\WINDOWS\system32\GroupPolicy\User\Scripts\Logoff</a>.<br>
<img border="0" src="Gruppenrichtlinie_Anmelden_Script_definieren.jpg" width="404" height="448"><br>
Da diese Scripts bei jedem User Logon / Logoff ausgeführt werden und die
Anmeldeparameter in den Properties enthalten sind, muss für jeden Benutzer eine
eigene Datei erstellt werden. Der Aufruf der richtigen Datei kann mit einem
kleinen Batch mit z.B. folgendem Inhalt definiert werden:<br>
if %USERNAME%==werner java -jar lpquickze_Kommt.jar<br>
<br>
<b>
Hinweis:<br>
</b>
Dass die in den An-/Abmeldescripts angeführten Programme keine Benutzereingaben
beinhalten dürfen ist selbstverständlich, da es NUR automatische Funktionen
sein können.<br>
<br>
<b>
Hinweis:<br>
</b>
Die Einstellungen können bequem von einem zum anderen PC übertragen werden, da
die Definition der Skripts in ini(s) abgelegt wird. Siehe dazu <a href="file:///c:/WINDOWS/system32/GroupPolicy/User/Scripts/Logon">c:\WINDOWS\system32\GroupPolicy\User\Scripts\</a>script.ini.<br>
<br>
<b>
Hinweis:</b> Für Definitionen, die nur beim Starten bzw. Herunterfahren des
Rechners durchgeführt werden sollen, verwenden Sie bitte die unter
Computerkonfiguration, Windows-Einstellungen, Skripts (Start/Herunterfahren) zu
definierenden Skripts. </p>

<p class="answer"><b>Wichtig:</b> Auf Windows-PCs wird versucht möglichst
schnell zu starten. In diesem Bestreben werden auch wichtige
Netzwerkverbindungen erst viel später aufgebaut. Das bedeutet, dass zu dem
Zeitpunkt an dem die Scripts auf den lokalen Rechner ausgeführt werden noch
keine Netzwerkverbindungen bestehen und daher auch die Scripts keine Wirkung
haben.<br>
Aus diesem Grunde muss das XP Professional Fast Logon Optimization feature
abgeschaltet werden. Siehe dazu bitte <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;305293&amp;Product=winxp">http://support.microsoft.com/default.aspx?scid=kb;en-us;305293&amp;Product=winxp</a>. </p>

<p class="answer"><b>Beschreibung der Spezialbuchungen:<br>
</b>Ziel dieser Buchungen ist vollautomatisch die Mitarbeiter beim Einschalten
des Clientrechners anzumelden. Da üblicherweise zuerst die Rechner
eingeschaltet werden, danach die morgendlichen Tätigkeiten (Kaffee, private
Emails, ..) erledigt werden, wird für den Mitarbeiter nach der Kommt Buchung
sofort eine Pause Beginn Buchung durchgeführt. Damit wird erreicht, dass
erkannt wird, wann der Mitarbeiter seinen Rechner eingeschaltet hat und parallel
dazu wann er tatsächlich auf Projekten gearbeitet hat. Wichtig: Damit die
Spezialbuchungen richtig angewendet werden können, muss Automatisches_Kommt
eingeschaltet sein (siehe Parameter). Als zusätzliche Aufgabenstellung kommt
dazu, dass sich Mitarbeiter quasi gleichzeitig auf mehreren Rechnern anmelden
können.<br>
<br>
<b>1.) spezialkommt<br>
</b>Mit dieser Buchung wird der Mitarbeiter mit Kommt als anwesend eingetragen
und danach sofort als in der Pause (Unter) befindlich gebucht. Ist der
Mitarbeiter bereits als anwesend eingetragen, da er z.B. auf einem anderen
Rechner angemeldet ist, so wird<br>
- wenn er bereits in der Pause ist, keine Buchung durchgeführt<br>
- wenn er auf einem Projekt arbeitet, so wird Pause Beginn gebucht.<br>
D.h. immer wenn Spezialkommt aufgerufen wird (beim automatischen Start des
Rechners), so wird sichergestellt, dass der Mitarbeiter angemeldet ist und dass
er in der Pause ist. Pause = Nichtbezahlte Abwesenheit.<br>
<br>
<b>2.) spezialgeht<br>
</b>Diese Buchung ist dafür gedacht aufgerufen zu werden, wenn der Rechner
abgeschaltet wird.<br>
Hier wird geprüft ob der Mitarbeiter bereits in der Pause ist, wenn ja wird
diese beendet und danach das Geht gebucht. Ist für den Mitarbeiter bereits als
letzte Buchung ein Geht eingetragen, z.B. da bereits der andere Rechner herunter
gefahren wurde, so wird keine weitere Buchung mehr durchgeführt.<br>
<br>
<b>Bearbeiten der Properties:</b><br>
Um die Properties zu bearbeiten muss in die Java Struktur gewechselt werden.
Verwenden Sie dazu z.B. <a href="http://www.ghisler.com/deutsch.htm">Totalcommander</a>.
Stellen Sie damit den Cursor auf das Programm z.B. lpquickze.jar. Nun gehen Sie
durch drücken von Strg+Bild nach unten in die Datei und gehen Sie auf ..\com\lp\lpquickze\props.properties.
Nun bearbeiten Sie die Datei props.properties. </p>

</body>

</html>
